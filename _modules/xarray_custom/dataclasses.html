

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xarray_custom.dataclasses &#8212; xarray-custom 0.6.2 documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/dataset-diagram-logo.png" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/astropenguin/xarray-custom" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for xarray_custom.dataclasses</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Module for creating custom DataArray classes.</span>

<span class="sd">This module provides functions which help to create a custom DataArray class</span>
<span class="sd">with fixed dimensions, datatype, and coordinates. Two functions are available:</span>

<span class="sd">- ``dataarrayclass``: Class decorator to construct a custom DataArray class.</span>
<span class="sd">- ``coord``: Create a DataArray class for the definition of a coordinate.</span>

<span class="sd">Examples:</span>
<span class="sd">    To create a custom DataArray class to represent images::</span>

<span class="sd">        @dataarrayclass</span>
<span class="sd">        class Image:</span>
<span class="sd">            \&quot;\&quot;\&quot;DataArray class to represent images.\&quot;\&quot;\&quot;</span>

<span class="sd">            accessor = &#39;img&#39;</span>
<span class="sd">            dims = &#39;x&#39;, &#39;y&#39;</span>
<span class="sd">            dtype = float</span>

<span class="sd">            x: coord(&#39;x&#39;, int) = 0</span>
<span class="sd">            y: coord(&#39;y&#39;, int) = 0</span>

<span class="sd">            def normalize(self):</span>
<span class="sd">                return self / self.max()</span>

<span class="sd">    The code style is similar to that of Python&#39;s dataclass.</span>
<span class="sd">    A DataArray is then created using the class::</span>

<span class="sd">        image = Image([[0, 1], [2, 3]], x=[0, 1], y=[0, 1])</span>
<span class="sd">        print(image)</span>

<span class="sd">        # &lt;xarray.DataArray (x: 2, y: 2)&gt;</span>
<span class="sd">        # array([[0., 1.],</span>
<span class="sd">        #        [2., 3.]])</span>
<span class="sd">        # Coordinates:</span>
<span class="sd">        #   * x        (x) int64 0 1</span>
<span class="sd">        #   * y        (y) int64 0 1</span>

<span class="sd">    Because ``dims``, ``dtype``, and coordinates are pre-defined,</span>
<span class="sd">    it is much easier to create a DataArray with given data.</span>
<span class="sd">    Custom methods can be used via an accessor::</span>

<span class="sd">        normalized = image.img.normalize()</span>
<span class="sd">        print(normalized)</span>

<span class="sd">        # &lt;xarray.DataArray (x: 2, y: 2)&gt;</span>
<span class="sd">        # array([[0.        , 0.33333333],</span>
<span class="sd">        #        [0.66666667, 1.        ]])</span>
<span class="sd">        # Coordinates:</span>
<span class="sd">        #   * x        (x) int64 0 1</span>
<span class="sd">        #   * y        (y) int64 0 1</span>

<span class="sd">    Like NumPy, several special class methods are available</span>
<span class="sd">    to create a DataArray filled with some values::</span>

<span class="sd">        ones = Image.ones((2, 2))</span>
<span class="sd">        print(ones)</span>

<span class="sd">        # &lt;xarray.DataArray (x: 2, y: 2)&gt;</span>
<span class="sd">        # array([[1., 1.],</span>
<span class="sd">        #        [1., 1.]])</span>
<span class="sd">        # Coordinates:</span>
<span class="sd">        #   * x        (x) int64 0 0</span>
<span class="sd">        #   * y        (y) int64 0 0</span>

<span class="sd">    Inheriting a custom DataArray class is possible to</span>
<span class="sd">    create a derivative DataArray class::</span>

<span class="sd">        class WeightedImage(Image):</span>
<span class="sd">            accessor = &#39;wimg&#39;</span>
<span class="sd">            w: coord((&#39;x&#39;, &#39;y&#39;), float) = 1.0</span>

<span class="sd">        zeros = Weightedimage.zeros((2, 2))</span>
<span class="sd">        print(zeros)</span>

<span class="sd">        # &lt;xarray.DataArray (x: 2, y: 2)&gt;</span>
<span class="sd">        # array([[1., 1.],</span>
<span class="sd">        #        [1., 1.]])</span>
<span class="sd">        # Coordinates:</span>
<span class="sd">        #   * x        (x) int64 0 0</span>
<span class="sd">        #   * y        (y) int64 0 0</span>
<span class="sd">        #     w        (x, y) float64 1.0 1.0 1.0 1.0</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;coord&quot;</span><span class="p">,</span> <span class="s2">&quot;dataarrayclass&quot;</span><span class="p">]</span>


<span class="c1"># standard library</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>


<span class="c1"># dependencies</span>
<span class="kn">from</span> <span class="nn">.bases</span> <span class="kn">import</span> <span class="n">DataArrayClassBase</span>
<span class="kn">from</span> <span class="nn">.typing</span> <span class="kn">import</span> <span class="n">Dims</span><span class="p">,</span> <span class="n">Dtype</span>


<span class="c1"># main functions</span>
<div class="viewcode-block" id="coord"><a class="viewcode-back" href="../../_apidoc/xarray_custom.html#xarray_custom.dataclasses.coord">[docs]</a><span class="k">def</span> <span class="nf">coord</span><span class="p">(</span>
    <span class="n">dims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dims</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dtype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">_</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Create a DataArray class for the definition of a coordinate.</span>

<span class="sd">    Args:</span>
<span class="sd">        dims: Dimensions of the coordinate.</span>
<span class="sd">        dtype: Datatype of the coordinate. Default is ``None``,</span>
<span class="sd">            which means that an input of any datatype is accepted.</span>
<span class="sd">        desc: Short description of the coordinate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataArray class for the coordinate.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">if</span> <span class="n">desc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="n">desc</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="s2">&quot;Coord&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">DataArrayClassBase</span><span class="p">,),</span> <span class="n">namespace</span><span class="p">)</span></div>


<div class="viewcode-block" id="dataarrayclass"><a class="viewcode-back" href="../../_apidoc/xarray_custom.html#xarray_custom.dataclasses.dataarrayclass">[docs]</a><span class="k">def</span> <span class="nf">dataarrayclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class decorator to construct a custom DataArray class.</span>

<span class="sd">    A class can define properties of DataArray to be created.</span>
<span class="sd">    The following class variables are accepted (see examples).</span>

<span class="sd">    - ``dims`` (str or tuple of str): Name(s) of dimension(s).</span>
<span class="sd">    - ``dtype`` (str or type): Datatype of DataArray.</span>
<span class="sd">    - ``desc`` (str): Short description of DataArray. Users can</span>
<span class="sd">        alternatively define it by a docstring (``__doc__``).</span>
<span class="sd">    - ``accessor`` (str): Name of accessor (if necessary).</span>

<span class="sd">    The coordinates of DataArray can also be defined as class</span>
<span class="sd">    variables using the ``coord`` function (see examples).</span>

<span class="sd">    Finally users can define custom instance methods which can</span>
<span class="sd">    be used by an accessor whose name is defined by ``accessor``.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls: Class to be decorated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorated class as a DataArray class.</span>

<span class="sd">    Examples:</span>
<span class="sd">        To create a custom DataArray class to represent images::</span>

<span class="sd">            @dataarrayclass</span>
<span class="sd">            class Image:</span>
<span class="sd">                \&quot;\&quot;\&quot;DataArray class to represent images.\&quot;\&quot;\&quot;</span>

<span class="sd">                accessor = &#39;img&#39;</span>
<span class="sd">                dims = &#39;x&#39;, &#39;y&#39;</span>
<span class="sd">                dtype = float</span>

<span class="sd">                x: coord(&#39;x&#39;, int) = 0</span>
<span class="sd">                y: coord(&#39;y&#39;, int) = 0</span>

<span class="sd">                def normalize(self):</span>
<span class="sd">                    return self / self.max()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="p">(</span><span class="n">DataArrayClassBase</span><span class="p">,),</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></div>
</pre></div>

              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, Akio Taniguchi.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>